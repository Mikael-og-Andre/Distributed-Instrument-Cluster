@inherits ComponentBase
@inject NavigationManager navigationManager
@using Blazor_Instrument_Cluster.Shared
@using System.ComponentModel.Design

<li id="DeviceItem" class="list-group-item container" style="width: 100%">
    <div class="row">
        <div class="col">
            <b>Name: </b> @deviceInfo.name
        </div>
        <div class="col">
            <b>Location: </b> @deviceInfo.location
        </div>
        <div class="col">
            <b>Type: </b> @deviceInfo.type
        </div>
        <div class="col">
            <button @onclick="navigateToDevicePage" class="btn-dark">Select</button>
        </div>
    </div>
    <div class="row">
        <div class="col">
            @foreach (var subDev in deviceInfo.subDevice) {
                <p>@subDev.subname</p>
            }
        </div>
        
    </div>
</li>

@code {
    /// <summary>
    /// Get DeviceModel passed in an use it to display info
    /// </summary>
    [Parameter]
    public DeviceModel deviceInfo { get; set; }

    private string basePath = "VideoAndControl/";

    private void navigateToDevicePage() {

        string crestronSubname = "crestronControl";
        int videoPort = 0;

        foreach (var subDevice in deviceInfo.subDevice) {

            if (subDevice.isVideoDevice) {
                videoPort = subDevice.port;
            }
            else {
                crestronSubname = subDevice.subname;
            }
                
        }

        string fullPath = basePath + deviceInfo.name + "/" + deviceInfo.location + "/" + deviceInfo.type + "/" + crestronSubname + "/" + videoPort;

        navigationManager.NavigateTo(fullPath);

    }

}

        